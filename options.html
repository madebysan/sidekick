<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sidekick â€” Settings</title>
  <link rel="stylesheet" href="options.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=DM+Sans:wght@400;500;600&family=IBM+Plex+Sans:wght@400;500;600&family=Source+Sans+3:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
  <div class="settings-container">
    <header class="settings-header">
      <h1>Sidekick</h1>
      <p class="subtitle">Settings</p>
    </header>

    <!-- API Configuration -->
    <section class="settings-section">
      <h2>API Configuration</h2>

      <div class="form-group">
        <label for="apiKey">API Key</label>
        <div class="input-with-toggle">
          <input type="password" id="apiKey" placeholder="sk-ant-..." autocomplete="off">
          <button type="button" class="toggle-visibility" id="toggleApiKey" title="Show/hide key">
            <svg class="eye-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
            <svg class="eye-off-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>
          </button>
        </div>
        <p class="form-hint">Get your API key from <a href="https://console.anthropic.com/settings/keys" target="_blank">console.anthropic.com</a></p>
      </div>

      <div class="form-group">
        <label for="model">Model</label>
        <select id="model">
          <option value="claude-sonnet-4-20250514">Sonnet 4 (recommended)</option>
          <option value="claude-opus-4-20250514">Opus 4 (smartest)</option>
          <option value="claude-haiku-4-5-20251001">Haiku 4.5 (fastest)</option>
          <option value="claude-3-5-haiku-20241022">Haiku 3.5 (budget)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="customSystemPrompt">Custom System Prompt</label>
        <textarea id="customSystemPrompt" placeholder="e.g. Always respond in Spanish, or Explain things like I'm a designer..." rows="3"></textarea>
        <p class="form-hint">Added to every conversation. Leave blank for default behavior.</p>
      </div>

      <div class="form-group">
        <label for="maxContext">Max Context Length</label>
        <input type="number" id="maxContext" min="1000" max="100000" step="1000" value="10000">
        <p class="form-hint">Maximum characters of page content to send as context (default: 10,000)</p>
      </div>
    </section>

    <!-- Text-to-Speech -->
    <section class="settings-section">
      <h2>Text-to-Speech</h2>

      <div class="form-group toggle-row">
        <div class="toggle-row-text">
          <label for="useDefaultVoice">Default Voice</label>
          <p class="form-hint">When on, Speak uses your selected voice automatically. When off, you choose a voice each time.</p>
        </div>
        <label class="toggle-switch">
          <input type="checkbox" id="useDefaultVoice">
          <span class="toggle-slider"></span>
        </label>
      </div>

      <div class="form-group">
        <label for="ttsEngine">Default Engine</label>
        <select id="ttsEngine">
          <option value="local">Browser (free)</option>
          <option value="elevenlabs">ElevenLabs (premium)</option>
        </select>
      </div>

      <!-- Browser voice settings -->
      <div id="localTtsSettings">
        <div class="form-group">
          <label for="localTtsVoice">Browser Voice</label>
          <div class="voice-row">
            <select id="localTtsVoice">
              <option value="">System Default</option>
            </select>
            <button type="button" id="testLocalVoice" class="btn btn-secondary btn-sm">Test</button>
          </div>
          <p class="form-hint">Voices provided by your browser/OS. Quality varies.</p>
        </div>
      </div>

      <!-- ElevenLabs settings -->
      <div id="elevenLabsTtsSettings">
        <div class="form-group">
          <label for="elevenLabsApiKey">ElevenLabs API Key</label>
          <div class="input-with-toggle">
            <input type="password" id="elevenLabsApiKey" placeholder="xi-..." autocomplete="off">
            <button type="button" class="toggle-visibility" id="toggleElevenLabsKey" title="Show/hide key">
              <svg class="eye-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
              <svg class="eye-off-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>
            </button>
          </div>
          <p class="form-hint">Get your API key from <a href="https://elevenlabs.io" target="_blank">elevenlabs.io</a></p>
        </div>

        <div class="form-group">
          <label for="elevenLabsVoice">ElevenLabs Voice</label>
          <div class="voice-row">
            <select id="elevenLabsVoice">
              <option value="">Enter API key to load voices</option>
            </select>
            <button type="button" id="refreshElevenLabsVoices" class="btn btn-secondary btn-sm" title="Refresh voices">Refresh</button>
            <button type="button" id="testElevenLabsVoice" class="btn btn-secondary btn-sm">Test</button>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label>Save Location</label>
        <p class="save-path-display">Downloads/Temp/sidekick-logs/</p>
        <p class="form-hint">Conversations and ElevenLabs audio are auto-saved here when a tab closes.</p>
      </div>
    </section>

    <!-- Appearance -->
    <section class="settings-section">
      <h2>Appearance</h2>

      <div class="form-group">
        <label>Theme</label>
        <div class="theme-options">
          <label class="theme-option">
            <input type="radio" name="theme" value="auto" checked>
            <span class="theme-label">Auto</span>
            <span class="theme-desc">Match system</span>
          </label>
          <label class="theme-option">
            <input type="radio" name="theme" value="light">
            <span class="theme-label">Light</span>
          </label>
          <label class="theme-option">
            <input type="radio" name="theme" value="dark">
            <span class="theme-label">Dark</span>
          </label>
        </div>
      </div>

      <div class="form-group">
        <label>Font</label>
        <div class="font-options">
          <label class="font-option">
            <input type="radio" name="fontFamily" value="system-ui" checked>
            <span class="font-preview" style="font-family: system-ui">System Default</span>
          </label>
          <label class="font-option">
            <input type="radio" name="fontFamily" value="'Inter', sans-serif">
            <span class="font-preview" style="font-family: 'Inter', sans-serif">Inter</span>
          </label>
          <label class="font-option">
            <input type="radio" name="fontFamily" value="'DM Sans', sans-serif">
            <span class="font-preview" style="font-family: 'DM Sans', sans-serif">DM Sans</span>
          </label>
          <label class="font-option">
            <input type="radio" name="fontFamily" value="'IBM Plex Sans', sans-serif">
            <span class="font-preview" style="font-family: 'IBM Plex Sans', sans-serif">IBM Plex Sans</span>
          </label>
          <label class="font-option">
            <input type="radio" name="fontFamily" value="'Source Sans 3', sans-serif">
            <span class="font-preview" style="font-family: 'Source Sans 3', sans-serif">Source Sans 3</span>
          </label>
        </div>
      </div>
    </section>

    <!-- Custom Commands -->
    <section class="settings-section">
      <h2>Custom Commands</h2>
      <p class="section-desc">Create slash commands that expand into prompts. Type <code>/name</code> in the chat to use them.</p>

      <div id="commandsList" class="commands-list"></div>

      <div id="commandForm" class="command-form" style="display:none;">
        <input type="text" id="commandName" placeholder="Command name (e.g. tldr)" class="command-input">
        <textarea id="commandPrompt" placeholder="Prompt text that replaces the command..." class="command-textarea" rows="3"></textarea>
        <div class="command-form-actions">
          <button type="button" id="saveCommand" class="btn btn-primary">Save</button>
          <button type="button" id="cancelCommand" class="btn btn-secondary">Cancel</button>
        </div>
      </div>

      <button type="button" id="addCommand" class="btn btn-secondary">+ Add Command</button>
    </section>

    <!-- Data -->
    <section class="settings-section">
      <h2>Data</h2>

      <div class="data-actions">
        <button type="button" id="exportSettings" class="btn btn-secondary">Export Settings</button>
        <button type="button" id="importSettings" class="btn btn-secondary">Import Settings</button>
        <input type="file" id="importFile" accept=".json" style="display:none">
      </div>
      <p class="form-hint">Export/import your settings and commands. API key is excluded from exports for security.</p>
    </section>

    <!-- Save status -->
    <div class="save-status" id="saveStatus"></div>
  </div>

  <script src="options.js"></script>
</body>
</html>
